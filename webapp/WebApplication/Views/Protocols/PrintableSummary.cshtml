@using K9.Base.WebApplication.Extensions
@using K9.Base.WebApplication.Helpers
@using K9.DataAccessLayer.Enums
@using K9.SharedLibrary.Authentication
@using K9.WebApplication.ViewModels
@using K9.SharedLibrary.Extensions
@model Protocol
@{
    Layout = "../Shared/_LayoutPrint.cshtml";
    ViewBag.OmitKeyWordsFromTitle = true;
    ViewBag.SubTitle = Model.Name;
    ViewBag.Title = Model.Name;
}

<div class="print-container schedule-print-container">
    <div class="row">
        <div class="col-xs-12 center-block">
            <img src="~/Images/company/logo-small.png" class="center-block" />
        </div>
    </div>
    <br />

    @if (Model.Type != EProtocolType.AutoGenerated || Model.IsScheduleDisplayed)
    {
        @Html.Partial("../Protocols/_Schedule")

        <br />
        <br />

        if (Model.Type != EProtocolType.ParasiteCleanse && Model.Type != EProtocolType.ParasiteCleanseMaintenance)
        {
            @Html.Partial("../Protocols/_SupplementsList")
        }
    }
</div>

@if (Model.Type == EProtocolType.AutoGenerated)
{
    using (Html.BeginForm())
    {
        using (Html.BeginBootstrapForm())
        {
            <div class="row">
                <div class="col-xs-12">
                    @Html.Raw(typeof(Dictionary).GetValueFromResource(Model.GenoTypeDetailsName))
                </div>
            </div>
        }
    }

    <div class="print-page-break">
        @using (Html.BeginForm())
        {
            using (Html.BeginBootstrapForm())
            {
                <div class="row">
                    <div class="col-xs-12">
                        @Html.Partial("../Protocols/_DoshasSummary")
                    </div>
                </div>
            }
        }
    </div>

    <div class="print-page-break">
        @using (Html.BeginForm())
        {
            using (Html.BeginBootstrapForm())
            {
                <div class="row">
                    <div class="col-xs-12">
                        @Html.Partial("../Protocols/_NineStarKiSummary", Model.NineStarKi)
                    </div>
                </div>
            }
        }
    </div>
}

@if (Model.RecommendedFoods != null && Model.RecommendedFoods.Any())
{
    <div class="print-page-break">
        @using (Html.BeginForm())
        {
            using (Html.BeginBootstrapForm())
            {
                <div class="row margin-top-0">
                    <div class="col-xs-12">
                        <h1 class="section-title margin-top-0">@Dictionary.RecommendedFoods</h1>
                    </div>
                </div>

                <br />

                <div class="row">
                    <div class="col-xs-12">
                        @Html.Partial("../Protocols/_PrintableFoodsList", new RecommendedFoodsViewModel
                        {
                            ClientId = Model.ClientId,
                            GenoType =  Model.GenoType,
                            Protocol = Model,
                            RecommendedFoods = Model.RecommendedFoods.Select(e =>
                            {
                                var foodItem = e.FoodItem;
                                foodItem.Score = e.Score;
                                foodItem.RelativeScore = e.RelativeScore;
                                return foodItem;
                            }).ToList()
                        })
                    </div>
                </div>
            }
        }
    </div>
}

@if (Model.DietaryRecommendations != null && Model.DietaryRecommendations.Any())
{
    <div class="print-page-break">
        @using (Html.BeginForm())
        {
            using (Html.BeginBootstrapForm())
            {
                <div class="row margin-top-0">
                    <div class="col-xs-12">
                        <h1 class="section-title margin-top-0">@Dictionary.DietaryAdvice</h1>
                    </div>
                </div>

                <br />

                <div class="row">
                    <div class="col-xs-12">
                        @Html.Partial("../Protocols/_DietaryRecommendationsPrintable")
                    </div>
                </div>
            }
        }
    </div>
}

@if (Model.Activities != null && Model.Activities.Any())
{
    <div class="print-page-break">
        @using (Html.BeginForm())
        {
            using (Html.BeginBootstrapForm())
            {
                <div class="row margin-top-0">
                    <div class="col-xs-12">
                        <h1 class="section-title margin-top-0">@Dictionary.RecommendedActivitties</h1>
                    </div>
                </div>

                <br />

                <div class="row">
                    <div class="col-xs-12">
                        @Html.Partial("../Protocols/_ActivityPrintable")
                    </div>
                </div>
            }
        }
    </div>
}
